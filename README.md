# my-washing-machine-heart

Я прописал класс __RecoverMissingData__, в котором представлено восемь методов заполнения пропусков в данных, и сделал 14 реализаций этих восьми методов.
Ниже будут представлены описания методов, их реализаций, а также результатов заполнения 

1) __TEST_fill_with_mean_by_column__. Сначало вводится две или три категории, по которым происходит разбиение датафрейма на секции и последующее заполнение пропусков средним. Если в секции слишком мало или нет данных, то заполняется средным по всему датафрейму.

2) __TEST_fill_with_median_by_column__. Работает по такому же принципу, что и __TEST_fill_with_mean_by_column__, но заполняет медианой.

3) __TEST_fill_with_mean_by_row__. Метод итерирует по всем строкам датафрейма и заполняет пропуски средним по строке.

4) __TEST_fill_with_median_by_row__. Работает по такому же принципу, что и __TEST_fill_with_mean_by_row__, но заполняет медианой.

5) __TEST_KNN_Imputer__. Сначало вводится от одной до трёх (включительно) категорий по которым происходит разбиение датафрейма на секции и заполняет пропуски с использованием алгоритма на основе к-ближайших соседей. Если данных не будет достаточно, то будет заполнение средним или медианой по колонке.

6) __TEST_KNN_wrapper__. Метод-обёртка для алгоритма __KNNImputer__.

7) __TEST_Miss_Forest__. Метод-обёртка для алгоритма __MissForest__. Стоит отметить, что ввиду размера датафрейма, не получилось реализовать этот метод, так как во время его тестирования вычислительные мощности моего компьютера были перегружены, что вызвало его зависание.

8) __TEST_Iterative_Imputer__. Метод-обёртка для __IterativeImputer__.


Метрика успешности алгоритма RMSE.


Результаты при отсутствии 5% данных:

  1) __TEST_fill_with_mean_by_column__.
     
       1.1. Разбиение на две категории:
     
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   7.24525e+08 |         1.24131e+08 |         9.71425e+07 |         1.99051e+08 |         2.01084e+08 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.91078e+08 |         1.5349e+08  |         1.64948e+08 |         2.10842e+08 |         2.42394e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   3.18146e+07 |         1.7364e+07  |         1.9611e+07  |         2.3547e+07  |         2.5366e+07  |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   7.07109e+08 |         1.22574e+09 |         8.94202e+08 |         1.5455e+09  |         2.01298e+09 |
            
       1.2. Разбиение на три категории: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   8.1012e+08  |         1.36115e+08 |         1.08885e+08 |         2.27434e+08 |         2.21454e+08 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.78968e+08 |         1.53073e+08 |         1.64598e+08 |         2.09972e+08 |         2.41611e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   3.14976e+07 |         1.6624e+07  |         1.86273e+07 |         2.2641e+07  |         2.4985e+07  |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   7.28585e+08 |         1.2263e+09  |         8.94639e+08 |         1.54528e+09 |         2.01416e+09 |

     
  2) __TEST_fill_with_median_by_column__.

       2.1. Разбиение на две категории:
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   7.25401e+08 |         1.27154e+08 |         1.0134e+08  |         2.03492e+08 |         1.93153e+08 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.23067e+08 |         1.50559e+08 |         1.62188e+08 |         2.07051e+08 |         2.38285e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   1.2474e+07  |         1.4095e+07  |         1.608e+07   |         1.959e+07   |         2.1734e+07  |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   4.33695e+08 |         1.22319e+09 |         8.90771e+08 |         1.5392e+09  |         2.00565e+09 |

     
       2.2. Разбиение на три категории: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   7.95545e+08 |         1.35985e+08 |         1.0891e+08  |         2.24149e+08 |         2.14193e+08 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.26823e+08 |         1.50718e+08 |         1.62304e+08 |         2.0722e+08  |         2.38592e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   1.2885e+07  |         1.4327e+07  |         1.6307e+07  |         1.9782e+07  |         2.1948e+07  |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   5.51026e+08 |         1.22427e+09 |         8.91783e+08 |         1.54201e+09 |         2.0081e+09  |


  3) __TEST_fill_with_mean_by_row__.

       3.1. 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   1.14861e+09 |         4.97098e+08 |         6.01329e+07 |         7.61998e+07 |         8.16881e+07 |
     | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
     | Imputed mean   |   1.79935e+08 |         1.52325e+08 |         1.59594e+08 |         2.02005e+08 |         2.27857e+08 |
     | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
     | Imputed median |   1.9143e+07  |         1.43135e+07 |         1.59665e+07 |         1.8747e+07  |         2.04535e+07 |
     | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
     | Imputed std    |   1.46391e+09 |         1.33571e+09 |         8.83835e+08 |         1.5803e+09  |         1.96642e+09 |

  4) __TEST_fill_with_median_by_row__.

       4.1. 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   4.06892e+08 |         1.23693e+08 |         5.83568e+07 |         8.36064e+07 |         8.56382e+07 |
     | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
     | Imputed mean   |   1.66221e+08 |         1.50834e+08 |         1.59324e+08 |         2.01333e+08 |         2.27555e+08 |
     | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
     | Imputed median |   1.7451e+07  |         1.42495e+07 |         1.5896e+07  |         1.86265e+07 |         2.0371e+07  |
     | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
     | Imputed std    |   8.84807e+08 |         1.23305e+09 |         8.83142e+08 |         1.57887e+09 |         1.96594e+09 |

  5) __TEST_KNN_Imputer__.

       5.1. Разбиение на одну категорию: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   5.61697e+08 |         1.17165e+08 |         7.25997e+07 |         1.8396e+08  |         1.00514e+08 |
     | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
     | Imputed mean   |   1.41571e+08 |         1.47037e+08 |         1.56718e+08 |         2.01208e+08 |         2.29164e+08 |
     | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
     | Imputed median |   1.84947e+07 |         1.41885e+07 |         1.57758e+07 |         1.8778e+07  |         2.07805e+07 |
     | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
     | Imputed std    |   5.48565e+08 |         1.21098e+09 |         8.72016e+08 |         1.57154e+09 |         1.96599e+09 |
     
       5.2. Разбиение на две категории: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   3.99921e+08 |         1.08231e+08 |         6.14434e+07 |         1.04666e+08 |         7.42764e+07 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.72125e+08 |         1.52881e+08 |         1.64084e+08 |         2.09722e+08 |         2.41201e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   1.89387e+07 |         1.5171e+07  |         1.7288e+07  |         2.0905e+07  |         2.3472e+07  |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   8.38644e+08 |         1.23352e+09 |         8.96212e+08 |         1.54869e+09 |         2.01501e+09 |

       5.3. Разбиение на три категории: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
     |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
     | RMSE           |   7.31938e+08 |         1.07721e+08 |         8.79512e+07 |         2.39586e+08 |         1.74121e+08 |
     | True mean      |   1.84375e+08 |         1.53006e+08 |         1.64799e+08 |         2.1103e+08  |         2.41499e+08 |
     | Imputed mean   |   1.50733e+08 |         1.51643e+08 |         1.6349e+08  |         2.08481e+08 |         2.39998e+08 |
     | True median    |   1.86755e+07 |         1.5123e+07  |         1.7313e+07  |         2.093e+07   |         2.3445e+07  |
     | Imputed median |   1.67035e+07 |         1.504e+07   |         1.72275e+07 |         2.0812e+07  |         2.335e+07   |
     | True std       |   9.31956e+08 |         1.23109e+09 |         8.98383e+08 |         1.55622e+09 |         2.01789e+09 |
     | Imputed std    |   6.95912e+08 |         1.22578e+09 |         8.93858e+08 |         1.54757e+09 |         2.01084e+09 |

  6) __TEST_KNN_wrapper__.

       6.1.
      |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
      |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
      | RMSE           |   3.11947e+08 |         7.303e+07   |         5.19737e+07 |         6.7252e+07  |         8.28017e+07 |
      | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
      | Imputed mean   |   1.56157e+08 |         1.47828e+08 |         1.57549e+08 |         2.02216e+08 |         2.29444e+08 |
      | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
      | Imputed median |   1.8397e+07  |         1.4174e+07  |         1.5779e+07  |         1.8756e+07  |         2.0766e+07  |
      | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
      | Imputed std    |   7.95123e+08 |         1.21522e+09 |         8.75854e+08 |         1.58444e+09 |         1.96808e+09 |
       
  7) __TEST_Miss_Forest__.

       7.1. Не получилось запустить.

  8) __TEST_Iterative_Imputer__.

       8.1. На основе градиентного бустинга: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
      |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
      | RMSE           |   4.97247e+08 |         8.03204e+07 |         4.64818e+07 |         1.67418e+08 |         1.12634e+08 |
      | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
      | Imputed mean   |   1.77893e+08 |         1.48459e+08 |         1.58226e+08 |         2.03191e+08 |         2.31498e+08 |
      | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
      | Imputed median |   3.49578e+07 |         1.6158e+07  |         1.5979e+07  |         2.15915e+07 |         2.0967e+07  |
      | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
      | Imputed std    |   8.17025e+08 |         1.21545e+09 |         8.77881e+08 |         1.57693e+09 |         1.97476e+09 |

       8.2. На основе случайного леса: Не получилось запустить.

       8.3. На основе метода опорных векторов: 
       |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
      |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
      | RMSE           |   6.86092e+08 |         2.62768e+08 |         4.81574e+07 |         1.13519e+08 |         9.82667e+07 |
      | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
      | Imputed mean   |   1.28096e+08 |         1.48182e+08 |         1.56582e+08 |         2.00196e+08 |         2.26479e+08 |
      | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
      | Imputed median |   1.34968e+07 |         1.4077e+07  |         1.5596e+07  |         1.84643e+07 |         2.0131e+07  |
      | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
      | Imputed std    |   8.6288e+08  |         1.24095e+09 |         8.74056e+08 |         1.57548e+09 |         1.96591e+09 |

       8.4. На основе к-ближайших соседей:
      |                |   Вся выборка |   2019, Доходы, RUB |   2020, Доходы, RUB |   2021, Доходы, RUB |   2022, Доходы, RUB |
      |:---------------|--------------:|--------------------:|--------------------:|--------------------:|--------------------:|
      | RMSE           |   3.3501e+08  |         8.89096e+07 |         3.34281e+07 |         8.18191e+07 |         8.16914e+07 |
      | True mean      |   1.66925e+08 |         1.48013e+08 |         1.58004e+08 |         2.03098e+08 |         2.3007e+08  |
      | Imputed mean   |   1.72695e+08 |         1.48491e+08 |         1.58103e+08 |         2.03038e+08 |         2.30704e+08 |
      | True median    |   1.7058e+07  |         1.40375e+07 |         1.5763e+07  |         1.87335e+07 |         2.0622e+07  |
      | Imputed median |   1.97679e+07 |         1.4225e+07  |         1.58555e+07 |         1.8841e+07  |         2.0829e+07  |
      | True std       |   8.61831e+08 |         1.2171e+09  |         8.77862e+08 |         1.58832e+09 |         1.96846e+09 |
      | Imputed std    |   8.46773e+08 |         1.21971e+09 |         8.77336e+08 |         1.58241e+09 |         1.97052e+09 |
       



Результаты оказались не самыми лучшими. 

Предположительные причины:

  1) Ненормальность распределения данных
  2) Объём данных, из-за которого не удалось применить часть алгоритмов
  3) Объём пропусков был выбран слишком большим
